<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Document</title>
  </head>
  <body>
    <p><span id="input"></span></p>

    <script>
      function generar_pesos(width, height, min, max) {
        var result = [];
        for (var i = 0; i < width; i++) {
          result[i] = [];
          for (var j = 0; j < height; j++) {
            result[i][j] =
              Math.random() * parseFloat(max - min) + parseFloat(min);
          }
        }
        return result;
      }

      function sigmoid(x) {
        const e = 2.71828;
        return 1 / (1 + Math.pow(e, -x));
      }

      function display(m) {
        for (var r = 0; r < m.length; ++r) {
          document.write("&nbsp;&nbsp;" + m[r].join(" ") + "<br />");
        }
      }

      let MatrixProd = (A, B) =>
        A.map((row, i) =>
          B[0].map((_, j) =>
            row.reduce((acc, _, n) => acc + A[i][n] * B[n][j], 0)
          )
        );

      class neuralNetwork {
        constructor(input_nodes, hidden_nodes, output_nodes, learning_rate) {
          //initialisation
          this.input_nodes = input_nodes;
          this.hidden_nodes = hidden_nodes;
          this.output_nodes = output_nodes;

          this.learning_rate = learning_rate;

          //generar pesos a capas
          this.wih = generar_pesos(
            this.hidden_nodes,
            this.input_nodes,
            -0.5,
            0.5
          );
          console.log("wih: " + this.wih);
          this.who = generar_pesos(
            this.hidden_nodes,
            this.output_nodes,
            -0.5,
            0.5
          );
          console.log("who: " + this.who);
        }

        train() {
          return;
        }

        query(inputs_list) {

            let inputs=[];
            while(inputs_list.length) inputs.push(inputs_list.splice(0,3));

            console.log(inputs)
            inputs= inputs_list//pendiente convertir a arreglo 2d
            
            //hidden capa
            //Multiplicaci贸n de matrices
            let hidden_inputs = MatrixProd(this.wih, inputs);
            console.log("dot hidden_inputs: "+hidden_inputs);
            
            //funcion sigmoide
            let hidden_outputs = sigmoid(hidden_inputs);
            console.log("hidden_sigmoide: "+hidden_outputs);
            
            
            //final capa
            //Multiplicaci贸n de matrices
            let final_inputs =  MatrixProd(this.who, hidden_outputs);
            console.log("dot final_inputs: "+hidden_inputs);
            
            //funcion sigmoide
          let final_outputs = sigmoid(hidden_inputs);
          console.log("final_sigmoide: "+hidden_outputs);

          return
        }
      }

      // Establecer propiedades de red
      let input_nodes = 3;
      let hidden_nodes = 3;
      let output_nodes = 3;
      let learning_rate = 0.3;

      // Crear instancia de la red
      let n = new neuralNetwork(
        input_nodes,
        hidden_nodes,
        output_nodes,
        learning_rate
      );
      
      n.query([1.0, 0.5, -1.5]);
      console.log();

      // console.log("----------------- Operaciones Capa Oculta ----------------");
      // for(j=0 ; j<nodosEntrada.length; j++){
      //     console.log("Entrada["+j+"]")
      //     let y=0.0;
      //     let x=0.0;
      //     let multiplicacion=0.0;

      //     for (i=0; i<2; i++){
      //         multiplicacion=(nodosEntrada[i]*pesos[i][j])
      //         x=multiplicacion+x;
      //     }

      //     console.log("x="+x);
      //     // console.log("----------------- Funci贸n de activaci贸n ----------------");
      //     y = sigmoid(x);
      //     console.log("y="+y);
      //     o.push(y);
      // }
      //     console.log("o="+o);

      // console.log("----------------- Salidas ----------------");

      // for(i=0 ; i<2 ; i++){
      //     nodos[i]=1;
      // }

      //Capa 2

      //capa salida

      // document.getElementById('input').innerHTML = w1+","+w2;
    </script>
  </body>
</html>
